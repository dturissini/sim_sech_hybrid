sqlite3 -header /proj/matutelb/projects/gwas/genotype_datasets/sech_oa/sim_sech_diff_sites.db
attach database '/proj/matutelb/projects/gwas/gwas_results/sech_oa_only_sim_pca/results/sech_oa_only_sim_pca_snp.db' as g;


select * 
from hybrid_sech_win 
where chrom = '2R' 
and win_size = 50000 
and 1.0 * num_sech_sites / total_diff_sites > .5;
hsw_id|win_size|chrom|start|end|hybrid_line|num_sech_sites|total_diff_sites
32965|50000|2R|20850001|20900000|Anro107|9|10
32967|50000|2R|20850001|20900000|Anro109|9|10
32968|50000|2R|20850001|20900000|Anro110|10|10
32969|50000|2R|20850001|20900000|Anro111|10|10
32973|50000|2R|20850001|20900000|Art6_71_sample1|8|10
32974|50000|2R|20850001|20900000|Art6_73_sample7|6|10
32976|50000|2R|20850001|20900000|BV1_Gas1|8|10


select *, 1.0*num_sech_sites / total_diff_sites 
from  hybrid_sech_win 
where chrom = '2R' 
and win_size = 50000 
and start = 20850001 
order by 1.0* num_sech_sites / total_diff_sites;
hsw_id|win_size|chrom|start|end|hybrid_line|num_sech_sites|total_diff_sites|1.0*num_sech_sites / total_diff_sites
32966|50000|2R|20850001|20900000|Anro108_sample6|1|10|0.1
32977|50000|2R|20850001|20900000|LD11_sample5|1|10|0.1
32982|50000|2R|20850001|20900000|sim_HPLD12|1|10|0.1
32984|50000|2R|20850001|20900000|sim_sey_Anro110_1_sampleo30|1|10|0.1
32986|50000|2R|20850001|20900000|sim_sey_HP12|1|10|0.1
32988|50000|2R|20850001|20900000|sim_sey_mose3_6_sample17|1|10|0.1
32970|50000|2R|20850001|20900000|Anro47_sample21|2|10|0.2
32971|50000|2R|20850001|20900000|Art66_sample4|2|10|0.2
32972|50000|2R|20850001|20900000|Art6_1_sampleA61|2|10|0.2
32979|50000|2R|20850001|20900000|sim_Anro103|2|10|0.2
32980|50000|2R|20850001|20900000|sim_Anro107|2|10|0.2
32978|50000|2R|20850001|20900000|sim_Anro102|3|10|0.3
32985|50000|2R|20850001|20900000|sim_sey_BV1_1_sampleo29|3|10|0.3
32981|50000|2R|20850001|20900000|sim_Anro109|4|10|0.4
32987|50000|2R|20850001|20900000|sim_sey_LD10|4|10|0.4
32975|50000|2R|20850001|20900000|Art8_sample20|5|10|0.5
32983|50000|2R|20850001|20900000|sim_mose5_point_4|5|10|0.5
32974|50000|2R|20850001|20900000|Art6_73_sample7|6|10|0.6
32973|50000|2R|20850001|20900000|Art6_71_sample1|8|10|0.8
32976|50000|2R|20850001|20900000|BV1_Gas1|8|10|0.8
32965|50000|2R|20850001|20900000|Anro107|9|10|0.9
32967|50000|2R|20850001|20900000|Anro109|9|10|0.9
32968|50000|2R|20850001|20900000|Anro110|10|10|1.0
32969|50000|2R|20850001|20900000|Anro111|10|10|1.0


select distinct g.*
from hybrid_sech_win w, gwas_snp g
where w.chrom = '2R' 
and win_size = 50000 
and 1.0 * num_sech_sites / total_diff_sites > .5
and w.chrom = g.chrom
and pos between start and end;
snp_id|chrom|pos|p
2R_20875499|2R|20875499|1.4353e-17





select distinct g.chrom, g.pos, p, start, end, avg(1.0*num_sech_sites / total_diff_sites) avg_prop_diff, max(1.0*num_sech_sites / total_diff_sites) max_prop_diff
from gwas_snp g, hybrid_sech_win w
where p < 1e-15
and win_size = 50000 
and w.chrom = g.chrom
and pos between start and end
group by g.chrom, g.pos, p, start, end
order by g.chrom, pos;
chrom|pos|p|start|end|avg_prop_diff|max_prop_diff
2R|16949961|9.40609e-16|16900001|16950000|0.0202020202020202|0.0454545454545455
2R|18662238|7.72532e-26|18650001|18700000|0.0144444444444444|0.0333333333333333
2R|20553742|8.22606e-18|20550001|20600000|0.012043512043512|0.047008547008547
2R|20706853|2.10615e-16|20700001|20750000|0.0338283828382838|0.0792079207920792
2R|20875499|1.4353e-17|20850001|20900000|0.416666666666667|1.0
3R|11931782|4.42743e-18|11900001|11950000|0.0105994152046784|0.0208333333333333


select distinct g.*, hybrid_line, start, end, num_sech_sites, total_diff_sites, 1.0*num_sech_sites / total_diff_sites
from gwas_snp g, hybrid_sech_win w
where p < 1e-15
and win_size = 50000 
and w.chrom = g.chrom
and pos between start and end
order by chrom, pos, hybrid_line;
snp_id|chrom|pos|p|hybrid_line|start|end|num_sech_sites|total_diff_sites|1.0*num_sech_sites / total_diff_sites
2R_16949961|2R|16949961|9.40609e-16|Anro103|16900001|16950000|2|132|0.0151515151515152
2R_16949961|2R|16949961|9.40609e-16|Anro107|16900001|16950000|6|132|0.0454545454545455
2R_16949961|2R|16949961|9.40609e-16|Anro108_sample6|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|Anro109|16900001|16950000|6|132|0.0454545454545455
2R_16949961|2R|16949961|9.40609e-16|Anro110|16900001|16950000|6|132|0.0454545454545455
2R_16949961|2R|16949961|9.40609e-16|Anro111|16900001|16950000|6|132|0.0454545454545455
2R_16949961|2R|16949961|9.40609e-16|Art6_1_sampleA61|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|Art6_71_sample1|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|Art6_73_sample7|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|Art8_sample20|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|BV1_Gas1|16900001|16950000|6|132|0.0454545454545455
2R_16949961|2R|16949961|9.40609e-16|LaDigueGAT_sample22|16900001|16950000|2|132|0.0151515151515152
2R_16949961|2R|16949961|9.40609e-16|sim_Anro102|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|sim_Anro103|16900001|16950000|2|132|0.0151515151515152
2R_16949961|2R|16949961|9.40609e-16|sim_Anro107|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|sim_Anro109|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|sim_sey_Anro110_1_sampleo30|16900001|16950000|1|132|0.00757575757575758
2R_16949961|2R|16949961|9.40609e-16|sim_sey_BV1_1_sampleo29|16900001|16950000|3|132|0.0227272727272727

2R_18662238|2R|18662238|7.72532e-26|Anro107|18650001|18700000|3|150|0.02
2R_18662238|2R|18662238|7.72532e-26|Anro109|18650001|18700000|3|150|0.02
2R_18662238|2R|18662238|7.72532e-26|Anro110|18650001|18700000|3|150|0.02
2R_18662238|2R|18662238|7.72532e-26|Anro111|18650001|18700000|3|150|0.02
2R_18662238|2R|18662238|7.72532e-26|Anro47_sample21|18650001|18700000|2|150|0.0133333333333333
2R_18662238|2R|18662238|7.72532e-26|Art6_1_sampleA61|18650001|18700000|5|150|0.0333333333333333
2R_18662238|2R|18662238|7.72532e-26|Art6_71_sample1|18650001|18700000|1|150|0.00666666666666667
2R_18662238|2R|18662238|7.72532e-26|Art6_73_sample7|18650001|18700000|3|150|0.02
2R_18662238|2R|18662238|7.72532e-26|Art8_sample20|18650001|18700000|2|150|0.0133333333333333
2R_18662238|2R|18662238|7.72532e-26|BV1_Gas1|18650001|18700000|3|150|0.02
2R_18662238|2R|18662238|7.72532e-26|LD11_sample5|18650001|18700000|1|150|0.00666666666666667
2R_18662238|2R|18662238|7.72532e-26|LaDigueGAT_sample22|18650001|18700000|1|150|0.00666666666666667
2R_18662238|2R|18662238|7.72532e-26|sim_Anro103|18650001|18700000|1|150|0.00666666666666667
2R_18662238|2R|18662238|7.72532e-26|sim_Anro107|18650001|18700000|2|150|0.0133333333333333
2R_18662238|2R|18662238|7.72532e-26|sim_HPLD12|18650001|18700000|1|150|0.00666666666666667
2R_18662238|2R|18662238|7.72532e-26|sim_mose5_point_4|18650001|18700000|2|150|0.0133333333333333
2R_18662238|2R|18662238|7.72532e-26|sim_sey_Anro110_1_sampleo30|18650001|18700000|1|150|0.00666666666666667
2R_18662238|2R|18662238|7.72532e-26|sim_sey_BV1_1_sampleo29|18650001|18700000|2|150|0.0133333333333333

2R_20553742|2R|20553742|8.22606e-18|Anro103|20550001|20600000|1|234|0.00427350427350427
2R_20553742|2R|20553742|8.22606e-18|Anro107|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|Anro109|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|Anro110|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|Anro111|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|Anro47_sample21|20550001|20600000|3|234|0.0128205128205128
2R_20553742|2R|20553742|8.22606e-18|Art66_sample4|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|Art6_1_sampleA61|20550001|20600000|8|234|0.0341880341880342
2R_20553742|2R|20553742|8.22606e-18|Art6_71_sample1|20550001|20600000|11|234|0.047008547008547
2R_20553742|2R|20553742|8.22606e-18|Art6_73_sample7|20550001|20600000|9|234|0.0384615384615385
2R_20553742|2R|20553742|8.22606e-18|Art8_sample20|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|BV1_Gas1|20550001|20600000|1|234|0.00427350427350427
2R_20553742|2R|20553742|8.22606e-18|LD11_sample5|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|sim_Anro102|20550001|20600000|1|234|0.00427350427350427
2R_20553742|2R|20553742|8.22606e-18|sim_Anro107|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|sim_Anro109|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|sim_mose5_point_4|20550001|20600000|3|234|0.0128205128205128
2R_20553742|2R|20553742|8.22606e-18|sim_sey_Anro110_1_sampleo30|20550001|20600000|1|234|0.00427350427350427
2R_20553742|2R|20553742|8.22606e-18|sim_sey_BV1_1_sampleo29|20550001|20600000|1|234|0.00427350427350427
2R_20553742|2R|20553742|8.22606e-18|sim_sey_HP12|20550001|20600000|2|234|0.00854700854700855
2R_20553742|2R|20553742|8.22606e-18|sim_sey_LD10|20550001|20600000|1|234|0.00427350427350427
2R_20553742|2R|20553742|8.22606e-18|sim_sey_mose3_6_sample17|20550001|20600000|2|234|0.00854700854700855

2R_20706853|2R|20706853|2.10615e-16|Anro103|20700001|20750000|4|202|0.0198019801980198
2R_20706853|2R|20706853|2.10615e-16|Anro107|20700001|20750000|15|202|0.0742574257425743
2R_20706853|2R|20706853|2.10615e-16|Anro108_sample6|20700001|20750000|4|202|0.0198019801980198
2R_20706853|2R|20706853|2.10615e-16|Anro109|20700001|20750000|16|202|0.0792079207920792
2R_20706853|2R|20706853|2.10615e-16|Anro110|20700001|20750000|16|202|0.0792079207920792
2R_20706853|2R|20706853|2.10615e-16|Anro111|20700001|20750000|16|202|0.0792079207920792
2R_20706853|2R|20706853|2.10615e-16|Art6_1_sampleA61|20700001|20750000|2|202|0.0099009900990099
2R_20706853|2R|20706853|2.10615e-16|Art8_sample20|20700001|20750000|3|202|0.0148514851485149
2R_20706853|2R|20706853|2.10615e-16|BV1_Gas1|20700001|20750000|15|202|0.0742574257425743
2R_20706853|2R|20706853|2.10615e-16|LaDigueGAT_sample22|20700001|20750000|3|202|0.0148514851485149
2R_20706853|2R|20706853|2.10615e-16|sim_Anro102|20700001|20750000|1|202|0.00495049504950495
2R_20706853|2R|20706853|2.10615e-16|sim_Anro103|20700001|20750000|8|202|0.0396039603960396
2R_20706853|2R|20706853|2.10615e-16|sim_Anro107|20700001|20750000|4|202|0.0198019801980198
2R_20706853|2R|20706853|2.10615e-16|sim_Anro109|20700001|20750000|2|202|0.0099009900990099
2R_20706853|2R|20706853|2.10615e-16|sim_HPLD12|20700001|20750000|1|202|0.00495049504950495
2R_20706853|2R|20706853|2.10615e-16|sim_sey_Anro110_1_sampleo30|20700001|20750000|7|202|0.0346534653465347
2R_20706853|2R|20706853|2.10615e-16|sim_sey_BV1_1_sampleo29|20700001|20750000|5|202|0.0247524752475248
2R_20706853|2R|20706853|2.10615e-16|sim_sey_HP12|20700001|20750000|1|202|0.00495049504950495

2R_20875499|2R|20875499|1.4353e-17|Anro107|20850001|20900000|9|10|0.9
2R_20875499|2R|20875499|1.4353e-17|Anro108_sample6|20850001|20900000|1|10|0.1
2R_20875499|2R|20875499|1.4353e-17|Anro109|20850001|20900000|9|10|0.9
2R_20875499|2R|20875499|1.4353e-17|Anro110|20850001|20900000|10|10|1.0
2R_20875499|2R|20875499|1.4353e-17|Anro111|20850001|20900000|10|10|1.0
2R_20875499|2R|20875499|1.4353e-17|Anro47_sample21|20850001|20900000|2|10|0.2
2R_20875499|2R|20875499|1.4353e-17|Art66_sample4|20850001|20900000|2|10|0.2
2R_20875499|2R|20875499|1.4353e-17|Art6_1_sampleA61|20850001|20900000|2|10|0.2
2R_20875499|2R|20875499|1.4353e-17|Art6_71_sample1|20850001|20900000|8|10|0.8
2R_20875499|2R|20875499|1.4353e-17|Art6_73_sample7|20850001|20900000|6|10|0.6
2R_20875499|2R|20875499|1.4353e-17|Art8_sample20|20850001|20900000|5|10|0.5
2R_20875499|2R|20875499|1.4353e-17|BV1_Gas1|20850001|20900000|8|10|0.8
2R_20875499|2R|20875499|1.4353e-17|LD11_sample5|20850001|20900000|1|10|0.1
2R_20875499|2R|20875499|1.4353e-17|sim_Anro102|20850001|20900000|3|10|0.3
2R_20875499|2R|20875499|1.4353e-17|sim_Anro103|20850001|20900000|2|10|0.2
2R_20875499|2R|20875499|1.4353e-17|sim_Anro107|20850001|20900000|2|10|0.2
2R_20875499|2R|20875499|1.4353e-17|sim_Anro109|20850001|20900000|4|10|0.4
2R_20875499|2R|20875499|1.4353e-17|sim_HPLD12|20850001|20900000|1|10|0.1
2R_20875499|2R|20875499|1.4353e-17|sim_mose5_point_4|20850001|20900000|5|10|0.5
2R_20875499|2R|20875499|1.4353e-17|sim_sey_Anro110_1_sampleo30|20850001|20900000|1|10|0.1
2R_20875499|2R|20875499|1.4353e-17|sim_sey_BV1_1_sampleo29|20850001|20900000|3|10|0.3
2R_20875499|2R|20875499|1.4353e-17|sim_sey_HP12|20850001|20900000|1|10|0.1
2R_20875499|2R|20875499|1.4353e-17|sim_sey_LD10|20850001|20900000|4|10|0.4
2R_20875499|2R|20875499|1.4353e-17|sim_sey_mose3_6_sample17|20850001|20900000|1|10|0.1

3R_11931782|3R|11931782|4.42743e-18|Anro107|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|Anro109|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|Anro110|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|Anro111|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|Anro47_sample21|11900001|11950000|3|144|0.0208333333333333
3R_11931782|3R|11931782|4.42743e-18|Art66_sample4|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|Art6_1_sampleA61|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|Art6_71_sample1|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|Art6_73_sample7|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|Art8_sample20|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|BV1_Gas1|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|HP1_sample15|11900001|11950000|2|144|0.0138888888888889
3R_11931782|3R|11931782|4.42743e-18|sim_Anro102|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|sim_Anro103|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|sim_Anro109|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|sim_mose5_point_4|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|sim_sey_Anro110_1_sampleo30|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|sim_sey_BV1_1_sampleo29|11900001|11950000|1|144|0.00694444444444444
3R_11931782|3R|11931782|4.42743e-18|sim_sey_HP12|11900001|11950000|1|144|0.00694444444444444
